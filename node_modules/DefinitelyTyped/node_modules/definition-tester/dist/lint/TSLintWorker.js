'use strict';
var fs = require('fs');
var Linter = require('tslint');
var mc = require('manticore');
mc.registerTask(function lint(params, callback) {
    mc.assertType(params, 'object', 'params');
    mc.assertType(params.filePath, 'string', 'params.filePath');
    mc.assertType(params.options, 'object', 'params.options');
    fs.exists(params.filePath, function (exist) {
        if (!exist) {
            return callback(null, null);
        }
        fs.readFile(params.filePath, 'utf8', function (err, contents) {
            if (err) {
                callback(err, null);
                return;
            }
            var linter = new Linter(params.filePath, contents, params.options);
            var result = linter.lint();
            result.output = result.output.split('\n').reduce(function (memo, line) {
                if (line !== '') {
                    memo.push(line + '\n');
                }
                return memo;
            }, []).join('');
            callback(err, result);
        });
    });
});
